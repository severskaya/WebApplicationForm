DROP TABLE IF EXISTS FRIENDSHIP;
DROP TABLE IF EXISTS HOBBY;
DROP TABLE IF EXISTS MESSAGE;
DROP TABLE IF EXISTS PERSON;
DROP TABLE IF EXISTS PLACE;
DROP TABLE IF EXISTS POST;
DROP TABLE IF EXISTS POST_LIKES;

CREATE TABLE FRIENDSHIP (
    PERSON_ID INT NOT NULL
  , FRIEND_ID INT NOT NULL
  , DATE_FROM DATE
  , PRIMARY KEY (PERSON_ID,FRIEND_ID)
);

CREATE TABLE HOBBY (
    HOBBY_ID INT GENERATED BY DEFAULT AS IDENTITY
  , TITLE VARCHAR(200) NOT NULL
  , DESCRIPTION VARCHAR(500) NOT NULL
  , PRIMARY KEY (HOBBY_ID)
);

CREATE TABLE PERSON (
    PERSON_ID INT GENERATED BY DEFAULT AS IDENTITY
  , FIRST_NAME VARCHAR(25) NOT NULL
  , LAST_NAME VARCHAR(25) NOT NULL
  , LOGIN VARCHAR(25) NOT NULL
  , EMAIL VARCHAR(25) NOT NULL
  , BIRTHDAY DATE NOT NULL
  , PRIMARY KEY (PERSON_ID)
);

CREATE TABLE MESSAGE (
    MESSAGE_ID INT GENERATED BY DEFAULT AS IDENTITY
  , CONTENT VARCHAR(500) NOT NULL
  , PERSON_FROM INT
  , PERSON_TO INT
  , TIME_SENT TIMESTAMP
  , PRIMARY KEY (MESSAGE_ID)
);

CREATE TABLE PLACE (
    PLACE_ID INT GENERATED BY DEFAULT AS IDENTITY
  , TITLE VARCHAR(200) NOT NULL
  , DESCRIPTION VARCHAR(500) NOT NULL
  , LATITUDE INT(50)
  , LONGITUDE INT(50)
  , PRIMARY KEY (PLACE_ID)
);

CREATE TABLE POST (
    POST_ID INT GENERATED BY DEFAULT AS IDENTITY
  , PERSON_ID INT NOT NULL
  , TITLE VARCHAR(200) NOT NULL
  , CONTENT VARCHAR(500) NOT NULL
  , PLACE_TIME TIMESTAMP
  , PRIMARY KEY (POST_ID)
);

CREATE TABLE POST_LIKES (
    POST_ID INT NOT NULL
  , PERSON_ID INT NOT NULL
  , PRIMARY KEY (POST_ID, PERSON_ID)
);


ALTER TABLE FRIENDSHIP ADD CONSTRAINT FK1_FRIENDSHIP_PERSON FOREIGN KEY (PERSON_ID) REFERENCES PERSON;
ALTER TABLE FRIENDSHIP ADD CONSTRAINT FK2_FRIENDSHIP_PERSON FOREIGN KEY (FRIEND_ID) REFERENCES PERSON;

ALTER TABLE MESSAGE ADD CONSTRAINT FK1_MESSAGE_PERSON FOREIGN KEY (PERSON_FROM) REFERENCES PERSON;
ALTER TABLE MESSAGE ADD CONSTRAINT FK2_MESSAGE_PERSON FOREIGN KEY (PERSON_TO) REFERENCES PERSON;


ALTER TABLE POST_LIKES ADD CONSTRAINT FK_POST_LIKES_POST FOREIGN KEY (POST_ID) REFERENCES POST;
ALTER TABLE POST_LIKES ADD CONSTRAINT FK_POST_LIKES_PERSON FOREIGN KEY (PERSON_ID) REFERENCES POST;

ALTER TABLE HOBBY ADD CONSTRAINT UK_unique1 UNIQUE (TITLE);

ALTER TABLE PERSON ADD CONSTRAINT UK_unique2 UNIQUE (LOGIN);

ALTER TABLE POST ADD CONSTRAINT FK_POST_PERSON FOREIGN KEY (PERSON_ID) REFERENCES PERSON;



